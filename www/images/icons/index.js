
items = {
	"acciughe" : {
		"label" : "Acciughe",
		"value" : 1.02,
		"image" : "acciughe.png"
	},
	"acqua" : {
		"label" : "Acqua",
		"value" : 1,
		"image" : "acqua.png"
	},
	"aglio" : {
		"label" : "Aglio",
		"value" : 0.68,
		"image" : "aglio.png"
	},
	"agliotritata" : {
		"label" : "Aglio (tritato)",
		"value" : 0.64,
		"image" : "agliotritata.png"
	},
	"albicoccheessiccato" : {
		"label" : "Albicocche (essiccate)",
		"value" : 0.64,
		"image" : "albicoccheessiccato.png"
	},
	"albume" : {
		"label" : "Albume (uovo)",
		"value" : 0.93,
		"image" : "albume.png"
	},
	"alici" : {
		"label" : "Alici",
		"value" : 1.02,
		"image" : "acciughe.png"
	},
	"anacardi" : {
		"label" : "Anacardi",
		"value" : 0.47000000000000003,
		"image" : "anacardioliotorrefatto.png"
	},
	"arachidi" : {
		"label" : "Arachidi",
		"value" : 0.64,
		"image" : "arachidioliotorrefatto.png"
	},
	"avenamacinata" : {
		"label" : "Avena (macinata)",
		"value" : 0.68,
		"image" : "avenamacinata.png"
	},
	"avenafiocchi" : {
		"label" : "Avena (fiocchi)",
		"value" : 0.34,
		"image" : "avenafiocchi.png"
	},
	"bananeafette" : {
		"label" : "Banane (a fette)",
		"value" : 0.76,
		"image" : "bananeafette.png"
	},
	"bananepurea" : {
		"label" : "Banane (purea)",
		"value" : 0.97,
		"image" : "bananepurea.png"
	},
	"basilicoessiccato" : {
		"label" : "Basilico (essiccato)",
		"value" : 0.11,
		"image" : "basilicoessiccato.png"
	},
	"bicarbonatodisodio" : {
		"label" : "Bicarbonato di sodio",
		"value" : 0.87,
		"image" : "bicarbonatodisodio.png"
	},
	"bucciadaranciacandita" : {
		"label" : "Buccia d'arancia candita",
		"value" : 0.53,
		"image" : "bucciadaranciacandita.png"
	},
	"burro" : {
		"label" : "Burro",
		"value" : 0.97,
		"image" : "burro.png"
	},
	"burrodiarachidi" : {
		"label" : "Burro di arachidi",
		"value" : 0.76,
		"image" : "burrodiarachidi.png"
	},
	"caffemacinato" : {
		"label" : "Caffè (macinato)",
		"value" : 0.38,
		"image" : "caffemacinato.png"
	},
	"caffeistantaneo" : {
		"label" : "Caffè (istantaneo)",
		"value" : 0.23,
		"image" : "caffeistantaneo.png"
	},
	"canditiscorzadilimone" : {
		"label" : "Canditi, scorza di limone",
		"value" : 0.5700000000000001,
		"image" : "canditiscorzadilimone.png"
	},
	"cannellapolvere" : {
		"label" : "Cannella (in polvere)",
		"value" : 0.51,
		"image" : "cannellapolvere.png"
	},
	"carnibovinecotti" : {
		"label" : "Carni bovine (cotti)",
		"value" : 0.97,
		"image" : "carnibovinecotti.png"
	},
	"carnibovinecruda" : {
		"label" : "Carni bovine (cruda)",
		"value" : 0.93,
		"image" : "carnibovinecruda.png"
	},
	"cavolfiore" : {
		"label" : "Cavolfiore",
		"value" : 0.97,
		"image" : "cavolfiore.png"
	},
	"cavolotriturato" : {
		"label" : "Cavolo (triturato)",
		"value" : 1.44,
		"image" : "cavolotriturato.png"
	},
	"cerealiricekrispies" : {
		"label" : "Cereali (Tipo Rice Krispies)",
		"value" : 0.09,
		"image" : "cerealiricekrispies.png"
	},
	"chiodidigarofanointeri" : {
		"label" : "Chiodi di garofano (interi)",
		"value" : 0.38,
		"image" : "chiodidigarofanointeri.png"
	},
	"chiodidigarofanoinpolvere" : {
		"label" : "Chiodi di garofano (in polvere)",
		"value" : 0.4,
		"image" : "chiodidigarofanoinpolvere.png"
	},
	"cioccolatocacaoinpolvere" : {
		"label" : "Cioccolato (cacao in polvere)",
		"value" : 0.47000000000000003,
		"image" : "cioccolatocacaoinpolvere.png"
	},
	"cioccolatofuso" : {
		"label" : "Cioccolato (fuso)",
		"value" : 1.02,
		"image" : "cioccolatofuso.png"
	},
	"cioccolatograttugiato" : {
		"label" : "Cioccolato (grattugiato)",
		"value" : 0.42,
		"image" : "cioccolatograttugiato.png"
	},
	"cioccolatoscaglie" : {
		"label" : "Cioccolato in scaglie",
		"value" : 0.76,
		"image" : "cioccolatoscaglie.png"
	},
	"cipollaaffettata" : {
		"label" : "Cipolla (affettata)",
		"value" : 0.55,
		"image" : "cipollaaffettata.png"
	},
	"cipollatritata" : {
		"label" : "Cipolla (tritata)",
		"value" : 0.85,
		"image" : "cipollatritata.png"
	},
	"coccotriturato" : {
		"label" : "Cocco (triturato)",
		"value" : 0.32,
		"image" : "coccotriturato.png"
	},
	"crackersbriciole" : {
		"label" : "Crackers in briciole",
		"value" : 0.25,
		"image" : "crackersbriciole.png"
	},
	"cranberry" : {
		"label" : "Cranberry",
		"value" : 0.42,
		"image" : "cranberry.png"
	},
	"cremadigrano" : {
		"label" : "Crema di grano",
		"value" : 0.76,
		"image" : "cremadigrano.png"
	},
	"cremaditartaro" : {
		"label" : "Crema di tartaro",
		"value" : 0.64,
		"image" : "cremaditartaro.png"
	},
	"crusca" : {
		"label" : "Crusca",
		"value" : 0.23,
		"image" : "crusca.png"
	},
	"curcumainpolvere" : {
		"label" : "Curcuma (in polvere)",
		"value" : 0.59,
		"image" : "curcumainpolvere.png"
	},
	"dattero" : {
		"label" : "Dattero (senza seme)",
		"value" : 0.64,
		"image" : "dattero.png"
	},
	"eggpasta" : {
		"label" : "Egg pasta",
		"value" : 0.38,
		"image" : "eggpasta.png"
	},
	"erbacipollinafrescotritato" : {
		"label" : "Erba cipollina (fresco tritato)",
		"value" : 0.21,
		"image" : "erbacipollinafrescotritato.png"
	},
	"erbacipollinasecchitritati" : {
		"label" : "Erba cipollina (secchi tritati)",
		"value" : 0.03,
		"image" : "erbacipollinasecchitritati.png"
	},
	"fagiolisecchi" : {
		"label" : "Fagioli (secchi)",
		"value" : 0.85,
		"image" : "fagiolisecchi.png"
	},
	"farina" : {
		"label" : "Farina",
		"value" : 0.76,
		"image" : "farina.png"
	},
	"farinadeafsmith" : {
		"label" : "Farina (Deaf Smith)",
		"value" : 0.55,
		"image" : "farinadeafsmith.png"
	},
	"farinagranointero" : {
		"label" : "Farina (grano intero)",
		"value" : 0.55,
		"image" : "farinagranointero.png"
	},
	"farinagranosaraceno" : {
		"label" : "Farina (grano saraceno)",
		"value" : 0.72,
		"image" : "farinagranosaraceno.png"
	},
	"farinalegume" : {
		"label" : "Farina (legume)",
		"value" : 0.55,
		"image" : "farinalegume.png"
	},
	"farinapanedifrumento" : {
		"label" : "Farina (pane di frumento)",
		"value" : 0.42,
		"image" : "farinapanedifrumento.png"
	},
	"farinapatata" : {
		"label" : "Farina (patata)",
		"value" : 0.72,
		"image" : "farinapatata.png"
	},
	"farinariso" : {
		"label" : "Farina (riso)",
		"value" : 0.64,
		"image" : "farinariso.png"
	},
	"farinasegale" : {
		"label" : "Farina (segale)",
		"value" : 0.38,
		"image" : "farinasegale.png"
	},
	"farinasemola" : {
		"label" : "Farina (semola)",
		"value" : 0.74,
		"image" : "farinasemola.png"
	},
	"farinastatiunitipertuttigliusi" : {
		"label" : "Farina (Stati Uniti per tutti gli usi)",
		"value" : 0.42,
		"image" : "farinastatiunitipertuttigliusi.png"
	},
	"farinatorta" : {
		"label" : "Farina (torta)",
		"value" : 0.38,
		"image" : "farinatorta.png"
	},
	"farinaukautoraccolta" : {
		"label" : "Farina (U.K. auto-raccolta)",
		"value" : 0.47000000000000003,
		"image" : "farinaukautoraccolta.png"
	},
	"farinadavenanoncotti" : {
		"label" : "Farina d'avena (non cotti)",
		"value" : 0.34,
		"image" : "farinadavenanoncotti.png"
	},
	"farinadigranturcocornflour" : {
		"label" : "Farina di granturco (cornflour)",
		"value" : 0.64,
		"image" : "farinadigranturcocornflour.png"
	},
	"farinadimaisblu" : {
		"label" : "Farina di mais blu",
		"value" : 0.51,
		"image" : "farinadimaisblu.png"
	},
	"fichiessiccato" : {
		"label" : "Fichi (essiccato)",
		"value" : 0.7000000000000001,
		"image" : "fichiessiccato.png"
	},
	"fioridigiglioditigre" : {
		"label" : "Fiori di giglio di tigre",
		"value" : 0.17,
		"image" : "fioridigiglioditigre.png"
	}
}


var adapterFor = (function() {
  var url = require('url'),
    adapters = {
      'http:': require('http'),
      'https:': require('https'),
    };

  return function(inputUrl) {
    return adapters[url.parse(inputUrl).protocol]
  }
}());
fs = require('fs');

var Bing = require('node-bing-api')({ accKey: "21efliGoBxl5Z6ELyzouGRCjeT5bfJvu/1qPjddzwYc" });

cur = [];
for (x in items) {
	cur.push(x);
	}
	
	function process()
	{
		var el = items[cur.pop()];
		Bing.images( el.label, {top:4,
			imageFilters: {
      size: 'small',aspect:"square"
    }
		},function (err,res,images) { 

			if (typeof images == 'undefined')
				return process();		
			images = images.d.results;
			try{
			var file = fs.createWriteStream(el.image);
			
			var request = adapterFor(images[0].MediaUrl).get(images[0].MediaUrl, function (response) {
					response.pipe(file);
					console.log(images[0].MediaUrl);
					process();
				});
				}
				catch (e)
				{ return process();}
			/*
			[{
			"url": "http://steveangello.com/boss.jpg",
			"type": "image/jpeg",
			"width": 1024,
			"height": 768,
			"size": 102451,
			"thumbnail": {
			"url": "http://steveangello.com/thumbnail.jpg",
			"width": 512,
			"height": 512
			}
			}]
			 */
		});
	}
process();